// Generated by CoffeeScript 1.4.0

/*
  Application Initializers
*/


(function() {
  var ActionCollector, AppInitializer, RouteInitializer, SchemaInitializer;

  SchemaInitializer = require("" + __dirname + "/schema");

  RouteInitializer = require("" + __dirname + "/route");

  /*
    Action and Resource Collectors
  */


  ActionCollector = require("" + __dirname + "/../action/collector");

  AppInitializer = (function() {
    /*
        Method: constructor
    */

    function AppInitializer(schemasG, resourcesG, pluginsG, dbSettingsG, actionsG) {
      this._s = schemas;
      this._r = resources;
      this._p = plugins;
      this._dbSettings = dbSettings;
      this._initializers = {};
    }

    AppInitializer.prototype.init = function(clbk) {
      var _action, _resource, _schema,
        _this = this;
      this._initializers.schema = _schema = new SchemaInitializer(this._s, this._p, this._dbSettings);
      this._initializers.resource = _resource = new ResourceInitializer(this._r);
      this._initializers.action = _action = new ActionInitializer(this._p);
      return this.__init(function(err) {
        if (err != null) {
          console.error("Error In Application Initialization");
          return console.error(err.message);
        } else {
          return _resource.enrich();
        }
      });
    };

    AppInitializer.prototype.__init = function(clbk) {
      var _this = this;
      return this._initializers.schema.init(function(err) {
        return _this._initializers.resource.init(function(err) {
          return _this._initializers.action.init(function(err) {
            return clbk(null);
          });
        });
      });
    };

    return AppInitializer;

  })();

  module.exports = AppInitializer;

}).call(this);
